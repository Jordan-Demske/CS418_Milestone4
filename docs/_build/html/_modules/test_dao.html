
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>test_dao &#8212; CS418_Milestone_4  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for test_dao</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">configparser</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>

<span class="kn">from</span> <span class="nn">MySQL_DAO</span> <span class="kn">import</span> <span class="n">MySQL_DAO</span><span class="p">,</span> <span class="n">MySQLCursorManager</span><span class="p">,</span> <span class="n">MySQLConnectionManager</span>
<span class="kn">import</span> <span class="nn">mysql.connector</span>
<span class="kn">from</span> <span class="nn">mysql.connector</span> <span class="kn">import</span> <span class="n">errorcode</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>


<div class="viewcode-block" id="TMBTest"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest">[docs]</a><span class="k">class</span> <span class="nc">TMBTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;[ {</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:00:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:304858000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[55.218332,13.371672]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:10.8,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:94.3,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:97},</span>
<span class="s2">                {</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:00:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">AtoN</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:992111840,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">static_data</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">IMO</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Unknown</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Name</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">WIND FARM BALTIC1NW</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">VesselType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Undefined</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Length</span><span class="se">\&quot;</span><span class="s2">:60,</span><span class="se">\&quot;</span><span class="s2">Breadth</span><span class="se">\&quot;</span><span class="s2">:60,</span><span class="se">\&quot;</span><span class="s2">A</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">B</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">C</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">D</span><span class="se">\&quot;</span><span class="s2">:30},</span>
<span class="s2">                {</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:00:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:219005465,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[54.572602,11.929218]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">RoT</span><span class="se">\&quot;</span><span class="s2">:0,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:0,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:298.7,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:203},</span>
<span class="s2">                {</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:00:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:636092297,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[55.00316,12.809015]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">RoT</span><span class="se">\&quot;</span><span class="s2">:0,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:0.2,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:225.6,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:240},</span>
<span class="s2">                {</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:00:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">AtoN</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:636092297,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">static_data</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">IMO</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">9534298</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Name</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Johann</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">VesselType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Undefined</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Length</span><span class="se">\&quot;</span><span class="s2">:8,</span><span class="se">\&quot;</span><span class="s2">Breadth</span><span class="se">\&quot;</span><span class="s2">:12,</span><span class="se">\&quot;</span><span class="s2">A</span><span class="se">\&quot;</span><span class="s2">:4,</span><span class="se">\&quot;</span><span class="s2">B</span><span class="se">\&quot;</span><span class="s2">:4,</span><span class="se">\&quot;</span><span class="s2">C</span><span class="se">\&quot;</span><span class="s2">:4,</span><span class="se">\&quot;</span><span class="s2">D</span><span class="se">\&quot;</span><span class="s2">:8},</span>
<span class="s2">                {</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:00:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:257385000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[55.219403,13.127725]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">RoT</span><span class="se">\&quot;</span><span class="s2">:25.7,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:12.3,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:96.5,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:101},</span>
<span class="s2">                {</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:00:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:376503000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[54.519373,11.47914]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">RoT</span><span class="se">\&quot;</span><span class="s2">:0,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:7.6,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:294.4,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:290} ]&quot;&quot;&quot;</span>

<div class="viewcode-block" id="TMBTest.test_format_ais_message_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_format_ais_message_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_format_ais_message_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `format_ais_message` will format any dictionary to include the keys needed for an AIS Message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">ais_parameters</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">,</span> <span class="s1">&#39;MMSI&#39;</span><span class="p">,</span> <span class="s1">&#39;Timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">]</span>
        <span class="n">ais_message_data</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">format_ais_message</span><span class="p">({})</span>
        <span class="n">includes_params</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">ais_parameters</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ais_message_data</span><span class="p">:</span>
                <span class="n">includes_params</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">includes_params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_format_ais_message_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_format_ais_message_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_format_ais_message_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `format_ais_message` will format an ISO timestamp into one readable by MySQL.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">ais_message_data</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">format_ais_message</span><span class="p">({</span><span class="s2">&quot;Timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-11-18T00:00:00.000Z&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ais_message_data</span><span class="p">[</span><span class="s1">&#39;Timestamp&#39;</span><span class="p">],</span> <span class="s2">&quot;2020-11-18 00:00:00&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_format_ais_message_3"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_format_ais_message_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_format_ais_message_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `format_ais_message` will null IMOs that are listed as &#39;Unknown&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">ais_message_data</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">format_ais_message</span><span class="p">({</span><span class="s2">&quot;IMO&quot;</span><span class="p">:</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">ais_message_data</span><span class="p">[</span><span class="s1">&#39;IMO&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_format_position_report_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_format_position_report_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_format_position_report_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `format_position_report` will format any dictionary to include the keys needed for a Position Report.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">position_report_parameters</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;RoT&#39;</span><span class="p">,</span> <span class="s1">&#39;SoG&#39;</span><span class="p">,</span> <span class="s1">&#39;CoG&#39;</span><span class="p">,</span> <span class="s1">&#39;Heading&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="s1">&#39;Position&#39;</span><span class="p">]</span>
        <span class="n">position_report_data</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">format_position_report</span><span class="p">({})</span>
        <span class="n">includes_params</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">position_report_parameters</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">position_report_data</span><span class="p">:</span>
                <span class="n">includes_params</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">includes_params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_format_position_report_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_format_position_report_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_format_position_report_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `format_position_report` will null the &#39;Position&#39; attribute if it does not include point data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">position_report_data</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">format_position_report</span><span class="p">({</span><span class="s1">&#39;Position&#39;</span><span class="p">:</span> <span class="p">{}})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">position_report_data</span><span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_format_position_report_3"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_format_position_report_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_format_position_report_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `format_position_report` will count an &#39;Unknown value&#39; Status attribute as null.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">position_report_data</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">format_position_report</span><span class="p">({</span><span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;Unknown value&#39;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">position_report_data</span><span class="p">[</span><span class="s1">&#39;Status&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_format_static_data_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_format_static_data_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_format_static_data_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `format_static_data` will format any dictionary to include the keys needed for a Static Data message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">static_data_parameters</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CallSign&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;VesselType&#39;</span><span class="p">,</span> <span class="s1">&#39;CargoType&#39;</span><span class="p">,</span> <span class="s1">&#39;Length&#39;</span><span class="p">,</span> <span class="s1">&#39;Breadth&#39;</span><span class="p">,</span> <span class="s1">&#39;Draught&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;Destination&#39;</span><span class="p">,</span> <span class="s1">&#39;DestinationId&#39;</span><span class="p">,</span> <span class="s1">&#39;ETA&#39;</span><span class="p">]</span>
        <span class="n">static_data</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">format_static_data</span><span class="p">({})</span>
        <span class="n">includes_params</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">static_data_parameters</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">static_data</span><span class="p">:</span>
                <span class="n">includes_params</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">includes_params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_format_static_data_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_format_static_data_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_format_static_data_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `format_static_data` will format the &#39;ETA&#39; attribute from ISO to a MySQL-readable format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">static_data</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">format_static_data</span><span class="p">({</span><span class="s1">&#39;ETA&#39;</span><span class="p">:</span> <span class="s2">&quot;2020-12-20T09:00:00.000Z&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">static_data</span><span class="p">[</span><span class="s1">&#39;ETA&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2020-12-20 09:00:00&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_insert_ais_batch_interface_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_insert_ais_batch_interface_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_insert_ais_batch_interface_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `insert_ais_batch` takes a JSON string with multiple messages as input.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">inserted</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="s1">&#39;inserts&#39;</span> <span class="ow">in</span> <span class="n">inserted</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">inserted</span><span class="p">[</span><span class="s1">&#39;inserts&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">and</span> <span class="n">inserted</span><span class="p">[</span><span class="s1">&#39;inserts&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_insert_ais_batch_interface_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_insert_ais_batch_interface_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_insert_ais_batch_interface_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `insert_ais_batch` returns -1 if the input is not parsable JSON.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">inserted_count</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="s2">&quot;Not JSON&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">inserted_count</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_insert_ais_batch_interface_3"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_insert_ais_batch_interface_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_insert_ais_batch_interface_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `insert_ais_batch` returns -1 if the input is not a JSON array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">inserted_count</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:00:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:304858000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[55.218332,13.371672]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:10.8,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:94.3,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:97}&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">inserted_count</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_insert_ais_batch_actual_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_insert_ais_batch_actual_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_insert_ais_batch_actual_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `insert_ais_batch` returns the number of messages inserted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">inserted_count</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">inserted_count</span><span class="p">)[</span><span class="s1">&#39;inserts&#39;</span><span class="p">],</span> <span class="mi">7</span><span class="p">)</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span></div>

<div class="viewcode-block" id="TMBTest.test_insert_ais_batch_actual_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_insert_ais_batch_actual_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_insert_ais_batch_actual_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `insert_ais_batch` inserts correct data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;[{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:00:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:319904000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[55.218332,13.371672]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">RoT</span><span class="se">\&quot;</span><span class="s2">:25.7,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:10.8,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:94.3,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:97},</span>
<span class="s2">                {</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:00:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">AtoN</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:319904000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">static_data</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">IMO</span><span class="se">\&quot;</span><span class="s2">:1000021,</span><span class="se">\&quot;</span><span class="s2">Name</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Montkaj</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">VesselType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Yacht</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Length</span><span class="se">\&quot;</span><span class="s2">:78,</span><span class="se">\&quot;</span><span class="s2">Breadth</span><span class="se">\&quot;</span><span class="s2">:13,</span><span class="se">\&quot;</span><span class="s2">A</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">B</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">C</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">D</span><span class="se">\&quot;</span><span class="s2">:30}]&quot;&quot;&quot;</span><span class="p">)</span>
        <span class="n">ais_actual</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">319904000</span><span class="p">,</span> <span class="s1">&#39;Class A&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                      <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">319904000</span><span class="p">,</span> <span class="s1">&#39;AtoN&#39;</span><span class="p">,</span> <span class="mi">1000021</span><span class="p">)]</span>
        <span class="n">pos_actual</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Under way using engine&#39;</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;13.371672&#39;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;55.218332&#39;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;25.7&#39;</span><span class="p">),</span>
                       <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;10.8&#39;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;94.3&#39;</span><span class="p">),</span> <span class="mi">97</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
        <span class="n">stat_actual</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1000021</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Montkaj&#39;</span><span class="p">,</span> <span class="s1">&#39;Yacht&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">MySQLConnectionManager</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">MySQLCursorManager</span><span class="p">(</span><span class="n">con</span><span class="p">)</span> <span class="k">as</span> <span class="n">cursor</span><span class="p">:</span>
                    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                        <span class="sd">&quot;&quot;&quot;SELECT * FROM AIS_MESSAGE;&quot;&quot;&quot;</span><span class="p">)</span>
                    <span class="n">ais</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                        <span class="sd">&quot;&quot;&quot;SELECT * FROM POSITION_REPORT;&quot;&quot;&quot;</span><span class="p">)</span>
                    <span class="n">pos</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                        <span class="sd">&quot;&quot;&quot;SELECT * FROM STATIC_DATA;&quot;&quot;&quot;</span><span class="p">)</span>
                    <span class="n">stat</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

        <span class="k">except</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">ais</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">stat</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errorcode</span><span class="o">.</span><span class="n">ER_ACCESS_DENIED_ERROR</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Something is wrong with your user name or password&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errorcode</span><span class="o">.</span><span class="n">ER_BAD_DB_ERROR</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Database does not exist&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">((</span><span class="n">ais</span> <span class="o">==</span> <span class="n">ais_actual</span> <span class="ow">and</span> <span class="n">pos</span> <span class="o">==</span> <span class="n">pos_actual</span> <span class="ow">and</span> <span class="n">stat</span> <span class="o">==</span> <span class="n">stat_actual</span><span class="p">))</span></div>

<div class="viewcode-block" id="TMBTest.test_insert_ais_message_interface_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_insert_ais_message_interface_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_insert_ais_message_interface_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `insert_ais_message` exists, takes in a dictionary, and checks the type of message passed in.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">typeMsg</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:00:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class &quot;</span>
                                                    <span class="s2">&quot;A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:304858000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,&quot;</span>
                                                    <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[55.218332,&quot;</span>
                                                    <span class="s2">&quot;13.371672]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:10.8,&quot;</span>
                                                    <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:94.3,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:97}&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">typeMsg</span><span class="p">,</span> <span class="s2">&quot;pos&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_insert_ais_message_interface_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_insert_ais_message_interface_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_insert_ais_message_interface_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `insert_ais_message` checks the type of message passed in (static data).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">typeMsg</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:00:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class &quot;</span>
                                                    <span class="s2">&quot;A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:304858000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">static_data</span><span class="se">\&quot;</span><span class="s2">,&quot;</span>
                                                    <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[55.218332,&quot;</span>
                                                    <span class="s2">&quot;13.371672]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:10.8,&quot;</span>
                                                    <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:94.3,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:97}&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">typeMsg</span><span class="p">,</span> <span class="s2">&quot;stat&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_insert_ais_message_actual_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_insert_ais_message_actual_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_insert_ais_message_actual_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `insert_ais_message` returns a success message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:00:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:319904000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[55.218332,13.371672]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">RoT</span><span class="se">\&quot;</span><span class="s2">:25.7,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:10.8,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:94.3,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:97}&quot;</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="s1">&#39;success&#39;</span> <span class="ow">in</span> <span class="n">result</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_insert_ais_message_actual_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_insert_ais_message_actual_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_insert_ais_message_actual_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `insert_ais_message` inserts a position report message into the database correctly.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">ais_actual</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">319904000</span><span class="p">,</span> <span class="s1">&#39;Class A&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
        <span class="n">pos_actual</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Under way using engine&#39;</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;13.371672&#39;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;55.218332&#39;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;25.7&#39;</span><span class="p">),</span>
                       <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;10.8&#39;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;94.3&#39;</span><span class="p">),</span> <span class="mi">97</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:00:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:319904000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[55.218332,13.371672]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">RoT</span><span class="se">\&quot;</span><span class="s2">:25.7,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:10.8,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:94.3,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:97}&quot;</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">MySQLConnectionManager</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">MySQLCursorManager</span><span class="p">(</span><span class="n">con</span><span class="p">)</span> <span class="k">as</span> <span class="n">cursor</span><span class="p">:</span>
                    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                        <span class="sd">&quot;&quot;&quot;SELECT * FROM AIS_MESSAGE;&quot;&quot;&quot;</span><span class="p">)</span>
                    <span class="n">ais</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                        <span class="sd">&quot;&quot;&quot;SELECT * FROM POSITION_REPORT;&quot;&quot;&quot;</span><span class="p">)</span>
                    <span class="n">pos</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                        <span class="sd">&quot;&quot;&quot;SELECT * FROM STATIC_DATA;&quot;&quot;&quot;</span><span class="p">)</span>
                    <span class="n">stat</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

        <span class="k">except</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">ais</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">stat</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errorcode</span><span class="o">.</span><span class="n">ER_ACCESS_DENIED_ERROR</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Something is wrong with your user name or password&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errorcode</span><span class="o">.</span><span class="n">ER_BAD_DB_ERROR</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Database does not exist&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">ais</span> <span class="o">==</span> <span class="n">ais_actual</span> <span class="ow">and</span> <span class="n">pos</span> <span class="o">==</span> <span class="n">pos_actual</span> <span class="ow">and</span> <span class="n">stat</span> <span class="o">==</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="TMBTest.test_insert_ais_message_actual_3"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_insert_ais_message_actual_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_insert_ais_message_actual_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `insert_ais_message` inserts a static data message into the database correctly.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">ais_actual</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">319904000</span><span class="p">,</span> <span class="s1">&#39;AtoN&#39;</span><span class="p">,</span> <span class="mi">1000021</span><span class="p">)]</span>
        <span class="n">stat_actual</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000021</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Montkaj&#39;</span><span class="p">,</span> <span class="s1">&#39;Yacht&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:00:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">AtoN</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:319904000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">static_data</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">IMO</span><span class="se">\&quot;</span><span class="s2">:1000021,</span><span class="se">\&quot;</span><span class="s2">Name</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Montkaj</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">VesselType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Yacht</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Length</span><span class="se">\&quot;</span><span class="s2">:78,</span><span class="se">\&quot;</span><span class="s2">Breadth</span><span class="se">\&quot;</span><span class="s2">:13,</span><span class="se">\&quot;</span><span class="s2">A</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">B</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">C</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">D</span><span class="se">\&quot;</span><span class="s2">:30}&quot;</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">MySQLConnectionManager</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">MySQLCursorManager</span><span class="p">(</span><span class="n">con</span><span class="p">)</span> <span class="k">as</span> <span class="n">cursor</span><span class="p">:</span>
                    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                        <span class="sd">&quot;&quot;&quot;SELECT * FROM AIS_MESSAGE;&quot;&quot;&quot;</span><span class="p">)</span>
                    <span class="n">ais</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                        <span class="sd">&quot;&quot;&quot;SELECT * FROM POSITION_REPORT;&quot;&quot;&quot;</span><span class="p">)</span>
                    <span class="n">pos</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                        <span class="sd">&quot;&quot;&quot;SELECT * FROM STATIC_DATA;&quot;&quot;&quot;</span><span class="p">)</span>
                    <span class="n">stat</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

        <span class="k">except</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">ais</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">stat</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errorcode</span><span class="o">.</span><span class="n">ER_ACCESS_DENIED_ERROR</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Something is wrong with your user name or password&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errorcode</span><span class="o">.</span><span class="n">ER_BAD_DB_ERROR</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Database does not exist&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">ais</span> <span class="o">==</span> <span class="n">ais_actual</span> <span class="ow">and</span> <span class="n">stat</span> <span class="o">==</span> <span class="n">stat_actual</span> <span class="ow">and</span> <span class="n">pos</span> <span class="o">==</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="TMBTest.test_delete_ais_messages_interface"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_delete_ais_messages_interface">[docs]</a>    <span class="k">def</span> <span class="nf">test_delete_ais_messages_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `delete_ais_messages` exists and returns a success message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="s1">&#39;success&#39;</span> <span class="ow">in</span> <span class="n">result</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_delete_ais_messages_actual_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_delete_ais_messages_actual_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_delete_ais_messages_actual_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `delete_ais_messages` returns a success message when complete.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="s1">&#39;success&#39;</span> <span class="ow">in</span> <span class="n">result</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_delete_ais_messages_actual_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_delete_ais_messages_actual_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_delete_ais_messages_actual_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `delete_ais_messages` deletes all AIS Messages, leaving none left.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">MySQLConnectionManager</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">MySQLCursorManager</span><span class="p">(</span><span class="n">con</span><span class="p">)</span> <span class="k">as</span> <span class="n">cursor</span><span class="p">:</span>
                    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                        <span class="sd">&quot;&quot;&quot;SELECT COUNT(*) FROM AIS_MESSAGE;&quot;&quot;&quot;</span><span class="p">)</span>
                    <span class="n">count</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">except</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errorcode</span><span class="o">.</span><span class="n">ER_ACCESS_DENIED_ERROR</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Something is wrong with your user name or password&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errorcode</span><span class="o">.</span><span class="n">ER_BAD_DB_ERROR</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Database does not exist&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_delete_old_ais_messages_interface"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_delete_old_ais_messages_interface">[docs]</a>    <span class="k">def</span> <span class="nf">test_delete_old_ais_messages_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `delete_old_ais_messages` exists and uses no parameters, returning the number of deletions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">deletes</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">delete_old_ais_messages</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="s1">&#39;deletions&#39;</span> <span class="ow">in</span> <span class="n">deletes</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">deletes</span><span class="p">[</span><span class="s1">&#39;deletions&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">and</span> <span class="n">deletes</span><span class="p">[</span><span class="s1">&#39;deletions&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span></div>

<div class="viewcode-block" id="TMBTest.test_delete_old_ais_messages_actual_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_delete_old_ais_messages_actual_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_delete_old_ais_messages_actual_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `delete_old_ais_messages` lists the number of records deleted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>

        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">deletes</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">delete_old_ais_messages</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="s1">&#39;deletions&#39;</span> <span class="ow">in</span> <span class="n">deletes</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">deletes</span><span class="p">[</span><span class="s1">&#39;deletions&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">and</span> <span class="n">deletes</span><span class="p">[</span><span class="s1">&#39;deletions&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">7</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_delete_old_ais_messages_actual_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_delete_old_ais_messages_actual_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_delete_old_ais_messages_actual_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `delete_old_ais_messages` only deletes records older than 5 minutes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>

        <span class="c1"># All current AIS messages will be older than 5 minutes, so get rid of them</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>

        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">AtoN</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:319904000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">static_data</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">IMO</span><span class="se">\&quot;</span><span class="s2">:1000021,</span><span class="se">\&quot;</span><span class="s2">Name</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Montkaj</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">VesselType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Yacht</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Length</span><span class="se">\&quot;</span><span class="s2">:78,</span><span class="se">\&quot;</span><span class="s2">Breadth</span><span class="se">\&quot;</span><span class="s2">:13,</span><span class="se">\&quot;</span><span class="s2">A</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">B</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">C</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">D</span><span class="se">\&quot;</span><span class="s2">:30}&quot;</span><span class="p">))</span>
        <span class="n">deletes</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">delete_old_ais_messages</span><span class="p">())</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">MySQLConnectionManager</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">MySQLCursorManager</span><span class="p">(</span><span class="n">con</span><span class="p">)</span> <span class="k">as</span> <span class="n">cursor</span><span class="p">:</span>
                    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                        <span class="sd">&quot;&quot;&quot;SELECT COUNT(*) FROM AIS_MESSAGE;&quot;&quot;&quot;</span><span class="p">)</span>
                    <span class="n">count</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">except</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errorcode</span><span class="o">.</span><span class="n">ER_ACCESS_DENIED_ERROR</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Something is wrong with your user name or password&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errorcode</span><span class="o">.</span><span class="n">ER_BAD_DB_ERROR</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Database does not exist&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span>
            <span class="s1">&#39;deletions&#39;</span> <span class="ow">in</span> <span class="n">deletes</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">deletes</span><span class="p">[</span><span class="s1">&#39;deletions&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">and</span> <span class="n">deletes</span><span class="p">[</span><span class="s1">&#39;deletions&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">7</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_create_vessel_document_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_create_vessel_document_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_create_vessel_document_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `create_vessel_document` exists and returns a vessel document based on a vessel array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">create_vessel_document</span><span class="p">([</span><span class="mi">333</span><span class="p">,</span> <span class="mf">54.5</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">&quot;MMSI&quot;</span><span class="p">:</span> <span class="mi">333</span><span class="p">,</span>
            <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mf">54.5</span><span class="p">,</span>
            <span class="s2">&quot;long&quot;</span><span class="p">:</span> <span class="mf">12.0</span><span class="p">,</span>
            <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;IMO&quot;</span><span class="p">:</span> <span class="kc">None</span>
        <span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_create_vessel_document_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_create_vessel_document_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_create_vessel_document_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `create_vessel_document` correctly fills in optional vessel data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">create_vessel_document</span><span class="p">([</span><span class="mi">636092297</span><span class="p">,</span> <span class="mf">55.244508</span><span class="p">,</span> <span class="mf">12.967945</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">&quot;MMSI&quot;</span><span class="p">:</span> <span class="mi">636092297</span><span class="p">,</span>
            <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mf">55.244508</span><span class="p">,</span>
            <span class="s2">&quot;long&quot;</span><span class="p">:</span> <span class="mf">12.967945</span><span class="p">,</span>
            <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Johann&quot;</span><span class="p">,</span>
            <span class="s2">&quot;IMO&quot;</span><span class="p">:</span> <span class="mi">9534298</span>
        <span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_create_vessel_document_3"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_create_vessel_document_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_create_vessel_document_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `create_vessel_document` fails nicely when given an array that is too short</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">create_vessel_document</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">&quot;MMSI&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;long&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;IMO&quot;</span><span class="p">:</span> <span class="kc">None</span>
        <span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_get_optional_vessel_data_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_get_optional_vessel_data_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_optional_vessel_data_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `get_optional_vessel_data` exists and takes an MMSI as a parameter, returning an array of two values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">get_optional_vessel_data</span><span class="p">(</span><span class="mi">636092297</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span></div>

<div class="viewcode-block" id="TMBTest.test_get_optional_vessel_data_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_get_optional_vessel_data_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_optional_vessel_data_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `get_optional_vessel_data` returns null for both values if the MMSI is not found in the database.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">get_optional_vessel_data</span><span class="p">(</span><span class="mi">333</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;NULL&quot;</span><span class="p">,</span> <span class="s2">&quot;NULL&quot;</span><span class="p">])</span></div>

<div class="viewcode-block" id="TMBTest.test_get_optional_vessel_data_3"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_get_optional_vessel_data_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_optional_vessel_data_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `get_optional_vessel_data` returns the name and IMO of a vessel based on</span>
<span class="sd">        transient data if such data exists.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">AtoN</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:636092297,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">static_data</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">IMO</span><span class="se">\&quot;</span><span class="s2">:1234567,</span><span class="se">\&quot;</span><span class="s2">Name</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Not Johann</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">VesselType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Yacht</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Length</span><span class="se">\&quot;</span><span class="s2">:78,</span><span class="se">\&quot;</span><span class="s2">Breadth</span><span class="se">\&quot;</span><span class="s2">:13,</span><span class="se">\&quot;</span><span class="s2">A</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">B</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">C</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">D</span><span class="se">\&quot;</span><span class="s2">:30}&quot;</span><span class="p">))</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">get_optional_vessel_data</span><span class="p">(</span><span class="mi">636092297</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Not Johann&#39;</span><span class="p">,</span> <span class="mi">1234567</span><span class="p">])</span></div>

<div class="viewcode-block" id="TMBTest.test_get_optional_vessel_data_4"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_get_optional_vessel_data_4">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_optional_vessel_data_4</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `get_optional_vessel_data` returns the name and IMO of a vessel based on</span>
<span class="sd">        permanent data if no relevant transient data exists.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">get_optional_vessel_data</span><span class="p">(</span><span class="mi">636092297</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Johann&#39;</span><span class="p">,</span> <span class="mi">9534298</span><span class="p">])</span></div>

<div class="viewcode-block" id="TMBTest.test_get_vessel_imo_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_get_vessel_imo_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_vessel_imo_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `get_vessel_imo` exists, takes in an MMSI, and returns an IMO.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">get_vessel_imo</span><span class="p">(</span><span class="mi">636092297</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="mi">1234567</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_get_vessel_imo_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_get_vessel_imo_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_vessel_imo_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `get_vessel_imo` returns the correct IMO.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">get_vessel_imo</span><span class="p">(</span><span class="mi">636092297</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="mi">9534298</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_get_vessel_imo_3"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_get_vessel_imo_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_vessel_imo_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `get_vessel_imo` returns &#39;NULL&#39; on an unknown MMSI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">get_vessel_imo</span><span class="p">(</span><span class="mi">333</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="s2">&quot;NULL&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_get_vessel_name_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_get_vessel_name_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_vessel_name_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `get_vessel_name` exists, takes in an MMSI, and returns a name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">get_vessel_name</span><span class="p">(</span><span class="mi">636092297</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="s2">&quot;Fake Name&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_get_vessel_name_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_get_vessel_name_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_vessel_name_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `get_vessel_name` returns the correct name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">get_vessel_name</span><span class="p">(</span><span class="mi">636092297</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="s2">&quot;Johann&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_get_vessel_name_3"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_get_vessel_name_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_vessel_name_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `get_vessel_name` returns &#39;NULL&#39; on an unknown MMSI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">get_vessel_name</span><span class="p">(</span><span class="mi">333</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="s2">&quot;NULL&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_select_all_recent_positions_interface"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_select_all_recent_positions_interface">[docs]</a>    <span class="k">def</span> <span class="nf">test_select_all_recent_positions_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `select_all_recent_positions` exists, has no parameters, and returns an array of vessel documents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">select_all_recent_positions</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;vessels&quot;</span><span class="p">:</span> <span class="p">[{</span>
            <span class="s2">&quot;MMSI&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;long&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;IMO&quot;</span><span class="p">:</span> <span class="kc">None</span>
        <span class="p">}]})</span></div>

<div class="viewcode-block" id="TMBTest.test_select_all_recent_positions_actual"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_select_all_recent_positions_actual">[docs]</a>    <span class="k">def</span> <span class="nf">test_select_all_recent_positions_actual</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `select_all_recent_positions` shows the most recent positions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">results_actual</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vessels&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">304858000</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">55.218332</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">13.371672</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;St.Pauli&#39;</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="mi">8214358</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">219005465</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">54.572602</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">11.929218</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;NULL&#39;</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="s1">&#39;NULL&#39;</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">636092297</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">55.00316</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">12.809015</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johann&#39;</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="mi">9534298</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">257385000</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">55.219403</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">13.127725</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Kegums&#39;</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="mi">8813972</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">376503000</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">54.519373</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">11.47914</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Cooler Bay&#39;</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="mi">7818066</span><span class="p">}]}</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">select_all_recent_positions</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">results_actual</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_select_most_recent_from_mmsi_interface"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_select_most_recent_from_mmsi_interface">[docs]</a>    <span class="k">def</span> <span class="nf">test_select_most_recent_from_mmsi_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `select_most_recent_from_mmsi` exists, takes in an MMSI, and returns a position document.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">select_most_recent_from_mmsi</span><span class="p">(</span><span class="mi">636092297</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;MMSI&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;long&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;IMO&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_select_most_recent_from_mmsi_actual"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_select_most_recent_from_mmsi_actual">[docs]</a>    <span class="k">def</span> <span class="nf">test_select_most_recent_from_mmsi_actual</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `select_most_recent_from_mmsi` creates a position document based on the most recent position data</span>
<span class="sd">        of a vessel with a specific MMSI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">select_most_recent_from_mmsi</span><span class="p">(</span><span class="mi">636092297</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span>
            <span class="n">results</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">55.00316</span> <span class="ow">and</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;long&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">12.809015</span> <span class="ow">and</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;MMSI&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">636092297</span> <span class="ow">and</span> <span class="n">results</span><span class="p">[</span>
                <span class="s1">&#39;IMO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">9534298</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_read_vessel_data_interface"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_read_vessel_data_interface">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_vessel_data_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `read_vessel_data` exists and returns a vessel document.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">read_vessel_information</span><span class="p">(</span><span class="mi">538007975</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;MMSI&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;long&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;IMO&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_read_vessel_data_actual_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_read_vessel_data_actual_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_vessel_data_actual_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `read_vessel_data` returns information from a vessel found in transient data based on its MMSI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">read_vessel_information</span><span class="p">(</span><span class="mi">636092297</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">636092297</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">55.00316</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">12.809015</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="mi">9534298</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johann&#39;</span><span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_read_vessel_data_actual_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_read_vessel_data_actual_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_vessel_data_actual_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `read_vessel_data` returns information from a vessel found in permanent data based on its MMSI if</span>
<span class="sd">        there is no relevant transient data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">read_vessel_information</span><span class="p">(</span><span class="mi">538007975</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">538007975</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="mi">9474280</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Leni Selmer&#39;</span><span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_read_vessel_data_actual_3"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_read_vessel_data_actual_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_vessel_data_actual_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `read_vessel_data` returns null values in the document if the provided IMO is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">read_vessel_information</span><span class="p">(</span><span class="mi">538007975</span><span class="p">,</span> <span class="mi">123456789</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_read_vessel_data_actual_4"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_read_vessel_data_actual_4">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_vessel_data_actual_4</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `read_vessel_data` returns null values in the document if the provided name is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">read_vessel_information</span><span class="p">(</span><span class="mi">538007975</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;This Name Does Not Exist&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_read_vessel_data_actual_5"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_read_vessel_data_actual_5">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_vessel_data_actual_5</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `read_vessel_data` returns a vessel data document based on the optional IMO if it is found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">read_vessel_information</span><span class="p">(</span><span class="mi">636092297</span><span class="p">,</span> <span class="mi">9534298</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">636092297</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">55.00316</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">12.809015</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="mi">9534298</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johann&#39;</span><span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_read_vessel_data_actual_6"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_read_vessel_data_actual_6">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_vessel_data_actual_6</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `read_vessel_data` returns a vessel data document based on the optional Name if it is found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">read_vessel_information</span><span class="p">(</span><span class="mi">636092297</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Johann&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">636092297</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">55.00316</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">12.809015</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="mi">9534298</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Johann&#39;</span><span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_select_all_recent_in_tile_interface"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_select_all_recent_in_tile_interface">[docs]</a>    <span class="k">def</span> <span class="nf">test_select_all_recent_in_tile_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `select_all_recent_in_tile` exists, takes in a tile ID, and returns a list of vessels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">select_all_recent_in_tile</span><span class="p">(</span><span class="mi">5037</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;vessel&quot;</span><span class="p">:</span> <span class="p">[]})</span></div>

<div class="viewcode-block" id="TMBTest.test_select_all_recent_in_tile_actual_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_select_all_recent_in_tile_actual_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_select_all_recent_in_tile_actual_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `select_all_recent_in_tile` fails nicely when given an incorrect Id.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">select_all_recent_in_tile</span><span class="p">(</span><span class="mi">12345678</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;vessel&quot;</span><span class="p">:</span> <span class="p">[]})</span></div>

<div class="viewcode-block" id="TMBTest.test_select_all_recent_in_tile_actual_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_select_all_recent_in_tile_actual_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_select_all_recent_in_tile_actual_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `select_all_recent_in_tile` correctly returns a list of vessels that are in a Tile Id.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">select_all_recent_in_tile</span><span class="p">(</span><span class="mi">5428</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;vessel&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">219005465</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">54.572602</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">11.929218</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;NULL&#39;</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="s1">&#39;NULL&#39;</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">376503000</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">54.519373</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">11.47914</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Cooler Bay&#39;</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="mi">7818066</span><span class="p">}]})</span></div>

<div class="viewcode-block" id="TMBTest.test_create_port_document_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_create_port_document_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_create_port_document_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `create_port_document` fails nicely when given an array that is too short.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">create_port_document</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">&quot;Id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Country&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;long&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;MapView1_Id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;MapView2_Id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;MapView3_Id&quot;</span><span class="p">:</span> <span class="kc">None</span>
        <span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_create_port_document_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_create_port_document_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_create_port_document_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `create_port_document` correctly places values into a port document.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">create_port_document</span><span class="p">([</span><span class="mi">381</span><span class="p">,</span> <span class="s2">&quot;Nyborg&quot;</span><span class="p">,</span> <span class="s2">&quot;Denmark&quot;</span><span class="p">,</span> <span class="mf">55.298889</span><span class="p">,</span> <span class="mf">10.810833</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5331</span><span class="p">,</span> <span class="mi">53312</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">&quot;Id&quot;</span><span class="p">:</span> <span class="mi">381</span><span class="p">,</span>
            <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Nyborg&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Country&quot;</span><span class="p">:</span> <span class="s2">&quot;Denmark&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mf">55.298889</span><span class="p">,</span>
            <span class="s2">&quot;long&quot;</span><span class="p">:</span> <span class="mf">10.810833</span><span class="p">,</span>
            <span class="s2">&quot;MapView1_Id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MapView2_Id&quot;</span><span class="p">:</span> <span class="mi">5331</span><span class="p">,</span>
            <span class="s2">&quot;MapView3_Id&quot;</span><span class="p">:</span> <span class="mi">53312</span>
        <span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_read_all_matching_ports_interface_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_read_all_matching_ports_interface_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_all_matching_ports_interface_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `read_all_matching_ports` exists, takes in a port name as a parameter, and returns an array of port</span>
<span class="sd">        documents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">read_all_matching_ports</span><span class="p">(</span><span class="s2">&quot;Nyborg&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;ports&quot;</span><span class="p">:</span> <span class="p">[]})</span></div>

<div class="viewcode-block" id="TMBTest.test_read_all_matching_ports_interface_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_read_all_matching_ports_interface_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_all_matching_ports_interface_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `read_all_matching_ports` allows an optional country parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">read_all_matching_ports</span><span class="p">(</span><span class="s2">&quot;Nyborg&quot;</span><span class="p">,</span> <span class="s2">&quot;Denmark&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;ports&quot;</span><span class="p">:</span> <span class="p">[]})</span></div>

<div class="viewcode-block" id="TMBTest.test_read_all_matching_ports_actual_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_read_all_matching_ports_actual_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_all_matching_ports_actual_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `read_all_matching_ports` returns a correct port document based on the name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">read_all_matching_ports</span><span class="p">(</span><span class="s2">&quot;Nyborg&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;ports&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s1">&#39;Id&#39;</span><span class="p">:</span> <span class="mi">381</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Nyborg&#39;</span><span class="p">,</span> <span class="s1">&#39;Country&#39;</span><span class="p">:</span> <span class="s1">&#39;Denmark&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">10.810833</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">55.298889</span><span class="p">,</span>
             <span class="s1">&#39;MapView1_Id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;MapView2_Id&#39;</span><span class="p">:</span> <span class="mi">5331</span><span class="p">,</span> <span class="s1">&#39;MapView3_Id&#39;</span><span class="p">:</span> <span class="mi">53312</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;Id&#39;</span><span class="p">:</span> <span class="mi">4970</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Nyborg&#39;</span><span class="p">,</span> <span class="s1">&#39;Country&#39;</span><span class="p">:</span> <span class="s1">&#39;Denmark&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">10.790833</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">55.306944</span><span class="p">,</span>
             <span class="s1">&#39;MapView1_Id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;MapView2_Id&#39;</span><span class="p">:</span> <span class="mi">5331</span><span class="p">,</span> <span class="s1">&#39;MapView3_Id&#39;</span><span class="p">:</span> <span class="mi">53312</span><span class="p">}]})</span></div>

<div class="viewcode-block" id="TMBTest.test_read_all_matching_ports_actual_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_read_all_matching_ports_actual_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_all_matching_ports_actual_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `read_all_matching_ports` fails nicely on an unknown name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">read_all_matching_ports</span><span class="p">(</span><span class="s2">&quot;No port here.&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;ports&#39;</span><span class="p">:</span> <span class="p">[]})</span></div>

<div class="viewcode-block" id="TMBTest.test_read_all_matching_ports_actual_3"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_read_all_matching_ports_actual_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_all_matching_ports_actual_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `read_all_matching_ports` returns a correct port document based on the country.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">read_all_matching_ports</span><span class="p">(</span><span class="s2">&quot;Nyborg&quot;</span><span class="p">,</span> <span class="s2">&quot;Denmark&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;ports&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s1">&#39;Id&#39;</span><span class="p">:</span> <span class="mi">381</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Nyborg&#39;</span><span class="p">,</span> <span class="s1">&#39;Country&#39;</span><span class="p">:</span> <span class="s1">&#39;Denmark&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">10.810833</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">55.298889</span><span class="p">,</span>
             <span class="s1">&#39;MapView1_Id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;MapView2_Id&#39;</span><span class="p">:</span> <span class="mi">5331</span><span class="p">,</span> <span class="s1">&#39;MapView3_Id&#39;</span><span class="p">:</span> <span class="mi">53312</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;Id&#39;</span><span class="p">:</span> <span class="mi">4970</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Nyborg&#39;</span><span class="p">,</span> <span class="s1">&#39;Country&#39;</span><span class="p">:</span> <span class="s1">&#39;Denmark&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">10.790833</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">55.306944</span><span class="p">,</span>
             <span class="s1">&#39;MapView1_Id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;MapView2_Id&#39;</span><span class="p">:</span> <span class="mi">5331</span><span class="p">,</span> <span class="s1">&#39;MapView3_Id&#39;</span><span class="p">:</span> <span class="mi">53312</span><span class="p">}]})</span></div>

<div class="viewcode-block" id="TMBTest.test_read_all_matching_ports_actual_4"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_read_all_matching_ports_actual_4">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_all_matching_ports_actual_4</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `read_all_matching_ports` fails nicely on an unknown country.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">read_all_matching_ports</span><span class="p">(</span><span class="s2">&quot;Nyborg&quot;</span><span class="p">,</span> <span class="s2">&quot;Not a real country&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;ports&#39;</span><span class="p">:</span> <span class="p">[]})</span></div>

<div class="viewcode-block" id="TMBTest.test_read_ship_pos_in_ts3_given_port_interface"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_read_ship_pos_in_ts3_given_port_interface">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_ship_pos_in_ts3_given_port_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `read_ship_pos_in_ts3_given_port` exists, takes in a port name and country, and by default</span>
<span class="sd">        returns a list of port documents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">read_ship_pos_in_ts3_given_port</span><span class="p">(</span><span class="s2">&quot;Nyborg&quot;</span><span class="p">,</span> <span class="s2">&quot;Denmark&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;ports&quot;</span><span class="p">:</span> <span class="p">[{</span>
            <span class="s2">&quot;Id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Country&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;long&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;MapView1_Id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;MapView2_Id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;MapView3_Id&quot;</span><span class="p">:</span> <span class="kc">None</span>
        <span class="p">}]})</span></div>

<div class="viewcode-block" id="TMBTest.test_read_ship_pos_in_ts3_given_port_actual_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_read_ship_pos_in_ts3_given_port_actual_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_ship_pos_in_ts3_given_port_actual_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `read_ship_pos_in_ts3_given_port` fails nicely if no port exists with the given parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">read_ship_pos_in_ts3_given_port</span><span class="p">(</span><span class="s2">&quot;Fake Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Fake Port&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;ports&quot;</span><span class="p">:</span> <span class="p">[{</span>
            <span class="s2">&quot;Id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Country&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;long&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;MapView1_Id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;MapView2_Id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;MapView3_Id&quot;</span><span class="p">:</span> <span class="kc">None</span>
        <span class="p">}]})</span></div>

<div class="viewcode-block" id="TMBTest.test_read_ship_pos_in_ts3_given_port_actual_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_read_ship_pos_in_ts3_given_port_actual_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_ship_pos_in_ts3_given_port_actual_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `read_ship_pos_in_ts3_given_port` returns a list of ports if multiple exist under the parameters</span>
<span class="sd">        given.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">read_ship_pos_in_ts3_given_port</span><span class="p">(</span><span class="s2">&quot;Nyborg&quot;</span><span class="p">,</span> <span class="s2">&quot;Denmark&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;ports&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s1">&#39;Id&#39;</span><span class="p">:</span> <span class="mi">381</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Nyborg&#39;</span><span class="p">,</span> <span class="s1">&#39;Country&#39;</span><span class="p">:</span> <span class="s1">&#39;Denmark&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">10.810833</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">55.298889</span><span class="p">,</span> <span class="s1">&#39;MapView1_Id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
             <span class="s1">&#39;MapView2_Id&#39;</span><span class="p">:</span> <span class="mi">5331</span><span class="p">,</span> <span class="s1">&#39;MapView3_Id&#39;</span><span class="p">:</span> <span class="mi">53312</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;Id&#39;</span><span class="p">:</span> <span class="mi">4970</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Nyborg&#39;</span><span class="p">,</span> <span class="s1">&#39;Country&#39;</span><span class="p">:</span> <span class="s1">&#39;Denmark&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">10.790833</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">55.306944</span><span class="p">,</span> <span class="s1">&#39;MapView1_Id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
             <span class="s1">&#39;MapView2_Id&#39;</span><span class="p">:</span> <span class="mi">5331</span><span class="p">,</span> <span class="s1">&#39;MapView3_Id&#39;</span><span class="p">:</span> <span class="mi">53312</span><span class="p">}]})</span></div>

<div class="viewcode-block" id="TMBTest.test_read_ship_pos_in_ts3_given_port_actual_3"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_read_ship_pos_in_ts3_given_port_actual_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_read_ship_pos_in_ts3_given_port_actual_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `read_ship_pos_in_ts3_given_port` returns a list of positions if only one port exists under</span>
<span class="sd">        the parameters given.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">read_ship_pos_in_ts3_given_port</span><span class="p">(</span><span class="s2">&quot;Nysted&quot;</span><span class="p">,</span> <span class="s2">&quot;Denmark&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span>
            <span class="s1">&#39;vessel&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">219005465</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">54.572602</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">11.929218</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;NULL&#39;</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="s1">&#39;NULL&#39;</span><span class="p">}]})</span></div>

<div class="viewcode-block" id="TMBTest.test_select_most_recent_5_ship_positions_interface"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_select_most_recent_5_ship_positions_interface">[docs]</a>    <span class="k">def</span> <span class="nf">test_select_most_recent_5_ship_positions_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `select_most_recent_5_ship_positions` exists, takes in an MMSI, and returns a document with</span>
<span class="sd">        the MMSI, a list of positions, and the IMO.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">select_most_recent_5_ship_positions</span><span class="p">(</span><span class="mi">636092297</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;MMSI&quot;</span><span class="p">:</span> <span class="mi">636092297</span><span class="p">,</span> <span class="s2">&quot;Positions&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_select_most_recent_5_ship_positions_actual_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_select_most_recent_5_ship_positions_actual_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_select_most_recent_5_ship_positions_actual_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `select_most_recent_5_ship_positions` nicely fails when the MMSI is not found in position reports.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">select_most_recent_5_ship_positions</span><span class="p">(</span><span class="mi">333</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;MMSI&quot;</span><span class="p">:</span> <span class="mi">333</span><span class="p">,</span> <span class="s2">&quot;Positions&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_select_most_recent_5_ship_positions_actual_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_select_most_recent_5_ship_positions_actual_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_select_most_recent_5_ship_positions_actual_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `select_most_recent_5_ship_positions` returns an IMO if a correct one is found for the MMSI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">select_most_recent_5_ship_positions</span><span class="p">(</span><span class="mi">636092297</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;IMO&quot;</span><span class="p">],</span> <span class="mi">9534298</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_select_most_recent_5_ship_positions_actual_3"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_select_most_recent_5_ship_positions_actual_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_select_most_recent_5_ship_positions_actual_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `select_most_recent_5_ship_positions` returns no IMO if a correct one is not found for the MMSI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">select_most_recent_5_ship_positions</span><span class="p">(</span><span class="mi">319904000</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;IMO&quot;</span><span class="p">],</span> <span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_select_most_recent_5_ship_positions_actual_4"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_select_most_recent_5_ship_positions_actual_4">[docs]</a>    <span class="k">def</span> <span class="nf">test_select_most_recent_5_ship_positions_actual_4</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `select_most_recent_5_ship_positions` returns less than 5 results if less than 5 are found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">select_most_recent_5_ship_positions</span><span class="p">(</span><span class="mi">636092297</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">636092297</span><span class="p">,</span> <span class="s1">&#39;Positions&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">55.00316</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">12.809015</span><span class="p">}],</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="mi">9534298</span><span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_select_most_recent_5_ship_positions_actual_5"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_select_most_recent_5_ship_positions_actual_5">[docs]</a>    <span class="k">def</span> <span class="nf">test_select_most_recent_5_ship_positions_actual_5</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `select_most_recent_5_ship_positions` returns 5 results even if more are made.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:00:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:319904000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[54.234332,12.12542]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">RoT</span><span class="se">\&quot;</span><span class="s2">:25.7,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:10.8,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:94.3,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:97}&quot;</span><span class="p">))</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:01:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:319904000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[55.218332,13.391672]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">RoT</span><span class="se">\&quot;</span><span class="s2">:25.7,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:10.8,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:94.3,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:97}&quot;</span><span class="p">))</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:02:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:319904000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[56.218332,12.771672]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">RoT</span><span class="se">\&quot;</span><span class="s2">:25.7,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:10.8,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:94.3,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:97}&quot;</span><span class="p">))</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:03:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:319904000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[57.218332,9.378672]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">RoT</span><span class="se">\&quot;</span><span class="s2">:25.7,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:10.8,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:94.3,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:97}&quot;</span><span class="p">))</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:04:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:319904000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[58.218332,11.361672]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">RoT</span><span class="se">\&quot;</span><span class="s2">:25.7,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:10.8,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:94.3,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:97}&quot;</span><span class="p">))</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:05:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:319904000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[59.218332,12.351672]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">RoT</span><span class="se">\&quot;</span><span class="s2">:25.7,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:10.8,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:94.3,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:97}&quot;</span><span class="p">))</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">select_most_recent_5_ship_positions</span><span class="p">(</span><span class="mi">319904000</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">319904000</span><span class="p">,</span> <span class="s1">&#39;Positions&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">59.218332</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">12.351672</span><span class="p">},</span>
                                                                    <span class="p">{</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">58.218332</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">11.361672</span><span class="p">},</span>
                                                                    <span class="p">{</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">57.218332</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">9.378672</span><span class="p">},</span>
                                                                    <span class="p">{</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">56.218332</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">12.771672</span><span class="p">},</span>
                                                                    <span class="p">{</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">55.218332</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">13.391672</span><span class="p">}],</span>
                                   <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_recent_ships_positions_headed_to_given_portId_interface_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_recent_ships_positions_headed_to_given_portId_interface_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_recent_ships_positions_headed_to_given_portId_interface_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `recent_ships_positions_headed_to_given_portId` exists, takes in a port Id, and returns an array of</span>
<span class="sd">        vessel documents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">recent_ships_positions_headed_to_given_portId</span><span class="p">(</span><span class="mi">381</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;vessels&quot;</span><span class="p">:</span> <span class="p">[]})</span></div>

<div class="viewcode-block" id="TMBTest.test_recent_ships_positions_headed_to_given_portId_interface_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_recent_ships_positions_headed_to_given_portId_interface_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_recent_ships_positions_headed_to_given_portId_interface_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `recent_ships_positions_headed_to_given_portId` fails nicely when a Port Id that is not a destination</span>
<span class="sd">        for any vessel is supplied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">recent_ships_positions_headed_to_given_portId</span><span class="p">(</span><span class="mi">9000</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;vessels&quot;</span><span class="p">:</span> <span class="p">[]})</span></div>

<div class="viewcode-block" id="TMBTest.test_recent_ships_positions_headed_to_given_portId_actual"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_recent_ships_positions_headed_to_given_portId_actual">[docs]</a>    <span class="k">def</span> <span class="nf">test_recent_ships_positions_headed_to_given_portId_actual</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `recent_ships_positions_headed_to_given_portId` returns a list of vessels that have the port listed</span>
<span class="sd">        as a destination.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>

        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>

        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">AtoN</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">DestinationId</span><span class="se">\&quot;</span><span class="s2">:381,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:376503000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">static_data</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">IMO</span><span class="se">\&quot;</span><span class="s2">:1234567,</span><span class="se">\&quot;</span><span class="s2">Name</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Not Johann</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">VesselType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Yacht</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Length</span><span class="se">\&quot;</span><span class="s2">:78,</span><span class="se">\&quot;</span><span class="s2">Breadth</span><span class="se">\&quot;</span><span class="s2">:13,</span><span class="se">\&quot;</span><span class="s2">A</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">B</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">C</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">D</span><span class="se">\&quot;</span><span class="s2">:30}&quot;</span><span class="p">))</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">AtoN</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">DestinationId</span><span class="se">\&quot;</span><span class="s2">:381,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:219005465,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">static_data</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">IMO</span><span class="se">\&quot;</span><span class="s2">:1234567,</span><span class="se">\&quot;</span><span class="s2">Name</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Not Johann</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">VesselType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Yacht</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Length</span><span class="se">\&quot;</span><span class="s2">:78,</span><span class="se">\&quot;</span><span class="s2">Breadth</span><span class="se">\&quot;</span><span class="s2">:13,</span><span class="se">\&quot;</span><span class="s2">A</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">B</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">C</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">D</span><span class="se">\&quot;</span><span class="s2">:30}&quot;</span><span class="p">))</span>

        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:01:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:376503000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[55.218332,13.391672]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">RoT</span><span class="se">\&quot;</span><span class="s2">:25.7,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:10.8,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:94.3,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:97}&quot;</span><span class="p">))</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:02:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:219005465,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[56.218332,12.771672]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">RoT</span><span class="se">\&quot;</span><span class="s2">:25.7,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:10.8,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:94.3,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:97}&quot;</span><span class="p">))</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">recent_ships_positions_headed_to_given_portId</span><span class="p">(</span><span class="mi">381</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;vessels&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">219005465</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">56.218332</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">12.771672</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="mi">1234567</span><span class="p">},</span>
                                               <span class="p">{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">376503000</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">55.218332</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">13.391672</span><span class="p">,</span>
                                                <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="mi">1234567</span><span class="p">}]})</span></div>

<div class="viewcode-block" id="TMBTest.test_recent_ships_positions_headed_to_given_port_interface"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_recent_ships_positions_headed_to_given_port_interface">[docs]</a>    <span class="k">def</span> <span class="nf">test_recent_ships_positions_headed_to_given_port_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `recent_ships_positions_headed_to_given_port` exists, takes in a port name and a country, and returns</span>
<span class="sd">        a list of ports by default.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">recent_ships_positions_headed_to_given_port</span><span class="p">(</span><span class="s2">&quot;Nyborg&quot;</span><span class="p">,</span> <span class="s2">&quot;Denmark&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;ports&#39;</span><span class="p">:</span> <span class="p">[]})</span></div>

<div class="viewcode-block" id="TMBTest.test_recent_ships_positions_headed_to_given_port_actual_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_recent_ships_positions_headed_to_given_port_actual_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_recent_ships_positions_headed_to_given_port_actual_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `recent_ships_positions_headed_to_given_port` returns the positions of recent ships if a unique</span>
<span class="sd">        port is found using the parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>

        <span class="n">tmb</span><span class="o">.</span><span class="n">delete_ais_messages</span><span class="p">()</span>

        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">AtoN</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">DestinationId</span><span class="se">\&quot;</span><span class="s2">:4384,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:376503000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">static_data</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">IMO</span><span class="se">\&quot;</span><span class="s2">:1234567,</span><span class="se">\&quot;</span><span class="s2">Name</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Not Johann</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">VesselType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Yacht</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Length</span><span class="se">\&quot;</span><span class="s2">:78,</span><span class="se">\&quot;</span><span class="s2">Breadth</span><span class="se">\&quot;</span><span class="s2">:13,</span><span class="se">\&quot;</span><span class="s2">A</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">B</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">C</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">D</span><span class="se">\&quot;</span><span class="s2">:30}&quot;</span><span class="p">))</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">AtoN</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">DestinationId</span><span class="se">\&quot;</span><span class="s2">:4384,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:219005465,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">static_data</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">IMO</span><span class="se">\&quot;</span><span class="s2">:1234567,</span><span class="se">\&quot;</span><span class="s2">Name</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Not Johann</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">VesselType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Yacht</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Length</span><span class="se">\&quot;</span><span class="s2">:78,</span><span class="se">\&quot;</span><span class="s2">Breadth</span><span class="se">\&quot;</span><span class="s2">:13,</span><span class="se">\&quot;</span><span class="s2">A</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">B</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">C</span><span class="se">\&quot;</span><span class="s2">:30,</span><span class="se">\&quot;</span><span class="s2">D</span><span class="se">\&quot;</span><span class="s2">:30}&quot;</span><span class="p">))</span>

        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:01:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:376503000,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[55.218332,13.391672]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">RoT</span><span class="se">\&quot;</span><span class="s2">:25.7,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:10.8,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:94.3,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:97}&quot;</span><span class="p">))</span>
        <span class="n">tmb</span><span class="o">.</span><span class="n">insert_ais_message</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
            <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Timestamp</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2020-11-18T00:02:00.000Z</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Class</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Class A</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">MMSI</span><span class="se">\&quot;</span><span class="s2">:219005465,</span><span class="se">\&quot;</span><span class="s2">MsgType</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">position_report</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">Position</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">type</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Point</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">coordinates</span><span class="se">\&quot;</span><span class="s2">:[56.218332,12.771672]},</span><span class="se">\&quot;</span><span class="s2">Status</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">Under way using engine</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">RoT</span><span class="se">\&quot;</span><span class="s2">:25.7,</span><span class="se">\&quot;</span><span class="s2">SoG</span><span class="se">\&quot;</span><span class="s2">:10.8,</span><span class="se">\&quot;</span><span class="s2">CoG</span><span class="se">\&quot;</span><span class="s2">:94.3,</span><span class="se">\&quot;</span><span class="s2">Heading</span><span class="se">\&quot;</span><span class="s2">:97}&quot;</span><span class="p">))</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">recent_ships_positions_headed_to_given_port</span><span class="p">(</span><span class="s2">&quot;Nysted&quot;</span><span class="p">,</span> <span class="s2">&quot;Denmark&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span>
            <span class="s1">&#39;vessels&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">219005465</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">56.218332</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">12.771672</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Not Johann&#39;</span><span class="p">,</span> <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="mi">1234567</span><span class="p">},</span>
                        <span class="p">{</span><span class="s1">&#39;MMSI&#39;</span><span class="p">:</span> <span class="mi">376503000</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">55.218332</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">13.391672</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Not Johann&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;IMO&#39;</span><span class="p">:</span> <span class="mi">1234567</span><span class="p">}]})</span></div>

<div class="viewcode-block" id="TMBTest.test_recent_ships_positions_headed_to_given_port_actual_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_recent_ships_positions_headed_to_given_port_actual_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_recent_ships_positions_headed_to_given_port_actual_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `recent_ships_positions_headed_to_given_port` returns the a list of ports if no specific port was found</span>
<span class="sd">        with the criteria given.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">recent_ships_positions_headed_to_given_port</span><span class="p">(</span><span class="s2">&quot;Nyborg&quot;</span><span class="p">,</span> <span class="s2">&quot;Denmark&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;ports&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s1">&#39;Id&#39;</span><span class="p">:</span> <span class="mi">381</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Nyborg&#39;</span><span class="p">,</span> <span class="s1">&#39;Country&#39;</span><span class="p">:</span> <span class="s1">&#39;Denmark&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">10.810833</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">55.298889</span><span class="p">,</span> <span class="s1">&#39;MapView1_Id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
             <span class="s1">&#39;MapView2_Id&#39;</span><span class="p">:</span> <span class="mi">5331</span><span class="p">,</span> <span class="s1">&#39;MapView3_Id&#39;</span><span class="p">:</span> <span class="mi">53312</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;Id&#39;</span><span class="p">:</span> <span class="mi">4970</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Nyborg&#39;</span><span class="p">,</span> <span class="s1">&#39;Country&#39;</span><span class="p">:</span> <span class="s1">&#39;Denmark&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="mf">10.790833</span><span class="p">,</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="mf">55.306944</span><span class="p">,</span> <span class="s1">&#39;MapView1_Id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
             <span class="s1">&#39;MapView2_Id&#39;</span><span class="p">:</span> <span class="mi">5331</span><span class="p">,</span> <span class="s1">&#39;MapView3_Id&#39;</span><span class="p">:</span> <span class="mi">53312</span><span class="p">}]})</span></div>

<div class="viewcode-block" id="TMBTest.test_recent_ships_positions_headed_to_given_port_actual_3"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_recent_ships_positions_headed_to_given_port_actual_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_recent_ships_positions_headed_to_given_port_actual_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `recent_ships_positions_headed_to_given_port` nicely fails if no port is found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">recent_ships_positions_headed_to_given_port</span><span class="p">(</span><span class="s2">&quot;Nothing&quot;</span><span class="p">,</span> <span class="s2">&quot;Empty&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;ports&#39;</span><span class="p">:</span> <span class="p">[]})</span></div>

<div class="viewcode-block" id="TMBTest.test_recent_ships_positions_headed_to_given_port_actual_4"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_recent_ships_positions_headed_to_given_port_actual_4">[docs]</a>    <span class="k">def</span> <span class="nf">test_recent_ships_positions_headed_to_given_port_actual_4</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `recent_ships_positions_headed_to_given_port` nicely fails if a specific port is found, but no vessels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">recent_ships_positions_headed_to_given_port</span><span class="p">(</span><span class="s2">&quot;Dansk&quot;</span><span class="p">,</span> <span class="s2">&quot;Denmark&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;vessels&#39;</span><span class="p">:</span> <span class="p">[]})</span></div>

<div class="viewcode-block" id="TMBTest.test_create_tile_document_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_create_tile_document_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_create_tile_document_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `create_tile_document` fails nicely when given an array that is too short.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">create_tile_document</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Id&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;LongitudeW&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;LatitudeS&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;LongitudeE&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                                   <span class="s1">&#39;LatitudeN&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Scale&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;RasterFile&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;ImageWidth&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                                   <span class="s1">&#39;ImageHeight&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;ActualLongitudeW&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;ActualLatitudeS&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                                   <span class="s1">&#39;ActualLongitudeE&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;ActualLatitudeN&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;ContainerMapView_Id&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_create_tile_document_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_create_tile_document_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_create_tile_document_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `create_tile_document` correctly places values into a tile document.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">create_tile_document</span><span class="p">(</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;7.000000&#39;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;54.500000&#39;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;13.000000&#39;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;57.500000&#39;</span><span class="p">),</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
             <span class="s1">&#39;ROOT.png&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;7.000000&#39;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;54.316140&#39;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;13.000000&#39;</span><span class="p">),</span>
             <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;57.669343&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;LongitudeW&#39;</span><span class="p">:</span> <span class="mf">7.0</span><span class="p">,</span> <span class="s1">&#39;LatitudeS&#39;</span><span class="p">:</span> <span class="mf">54.5</span><span class="p">,</span> <span class="s1">&#39;LongitudeE&#39;</span><span class="p">:</span> <span class="mf">13.0</span><span class="p">,</span>
                                   <span class="s1">&#39;LatitudeN&#39;</span><span class="p">:</span> <span class="mf">57.5</span><span class="p">,</span> <span class="s1">&#39;Scale&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;RasterFile&#39;</span><span class="p">:</span> <span class="s1">&#39;ROOT.png&#39;</span><span class="p">,</span> <span class="s1">&#39;ImageWidth&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>
                                   <span class="s1">&#39;ImageHeight&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;ActualLongitudeW&#39;</span><span class="p">:</span> <span class="mf">7.0</span><span class="p">,</span> <span class="s1">&#39;ActualLatitudeS&#39;</span><span class="p">:</span> <span class="mf">54.31614</span><span class="p">,</span>
                                   <span class="s1">&#39;ActualLongitudeE&#39;</span><span class="p">:</span> <span class="mf">13.0</span><span class="p">,</span> <span class="s1">&#39;ActualLatitudeN&#39;</span><span class="p">:</span> <span class="mf">57.669343</span><span class="p">,</span> <span class="s1">&#39;ContainerMapView_Id&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_given_tile_find_contained_tiles_interface"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_given_tile_find_contained_tiles_interface">[docs]</a>    <span class="k">def</span> <span class="nf">test_given_tile_find_contained_tiles_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `given_tile_find_contained_tiles` exists, takes in a tile id, and returns a list of tiles.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">given_tile_find_contained_tiles</span><span class="p">(</span><span class="mi">5036</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;tiles&#39;</span><span class="p">:</span> <span class="p">[]})</span></div>

<div class="viewcode-block" id="TMBTest.test_given_tile_find_contained_tiles_actual_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_given_tile_find_contained_tiles_actual_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_given_tile_find_contained_tiles_actual_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `given_tile_find_contained_tiles` nicely fails when given a wrong tile Id.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">given_tile_find_contained_tiles</span><span class="p">(</span><span class="mi">9999999</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;tiles&#39;</span><span class="p">:</span> <span class="p">[]})</span></div>

<div class="viewcode-block" id="TMBTest.test_given_tile_find_contained_tiles_actual_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_given_tile_find_contained_tiles_actual_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_given_tile_find_contained_tiles_actual_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `given_tile_find_contained_tiles` correctly finds the four tiles that the tile Id passed in contains</span>
<span class="sd">        and lists them in an array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tmb</span><span class="o">.</span><span class="n">given_tile_find_contained_tiles</span><span class="p">(</span><span class="mi">5036</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;tiles&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s1">&#39;Id&#39;</span><span class="p">:</span> <span class="mi">50361</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;38F71&#39;</span><span class="p">,</span> <span class="s1">&#39;LongitudeW&#39;</span><span class="p">:</span> <span class="mf">7.0</span><span class="p">,</span> <span class="s1">&#39;LatitudeS&#39;</span><span class="p">:</span> <span class="mf">54.75</span><span class="p">,</span> <span class="s1">&#39;LongitudeE&#39;</span><span class="p">:</span> <span class="mf">7.5</span><span class="p">,</span> <span class="s1">&#39;LatitudeN&#39;</span><span class="p">:</span> <span class="mf">55.0</span><span class="p">,</span>
             <span class="s1">&#39;Scale&#39;</span><span class="p">:</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;RasterFile&#39;</span><span class="p">:</span> <span class="s1">&#39;38F71.png&#39;</span><span class="p">,</span> <span class="s1">&#39;ImageWidth&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;ImageHeight&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;ActualLongitudeW&#39;</span><span class="p">:</span> <span class="mf">7.0</span><span class="p">,</span>
             <span class="s1">&#39;ActualLatitudeS&#39;</span><span class="p">:</span> <span class="mf">54.731097</span><span class="p">,</span> <span class="s1">&#39;ActualLongitudeE&#39;</span><span class="p">:</span> <span class="mf">7.5</span><span class="p">,</span> <span class="s1">&#39;ActualLatitudeN&#39;</span><span class="p">:</span> <span class="mf">55.018777</span><span class="p">,</span>
             <span class="s1">&#39;ContainerMapView_Id&#39;</span><span class="p">:</span> <span class="mi">5036</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;Id&#39;</span><span class="p">:</span> <span class="mi">50362</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;38F72&#39;</span><span class="p">,</span> <span class="s1">&#39;LongitudeW&#39;</span><span class="p">:</span> <span class="mf">7.5</span><span class="p">,</span> <span class="s1">&#39;LatitudeS&#39;</span><span class="p">:</span> <span class="mf">54.75</span><span class="p">,</span> <span class="s1">&#39;LongitudeE&#39;</span><span class="p">:</span> <span class="mf">8.0</span><span class="p">,</span> <span class="s1">&#39;LatitudeN&#39;</span><span class="p">:</span> <span class="mf">55.0</span><span class="p">,</span>
             <span class="s1">&#39;Scale&#39;</span><span class="p">:</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;RasterFile&#39;</span><span class="p">:</span> <span class="s1">&#39;38F72.png&#39;</span><span class="p">,</span> <span class="s1">&#39;ImageWidth&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;ImageHeight&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;ActualLongitudeW&#39;</span><span class="p">:</span> <span class="mf">7.5</span><span class="p">,</span>
             <span class="s1">&#39;ActualLatitudeS&#39;</span><span class="p">:</span> <span class="mf">54.731097</span><span class="p">,</span> <span class="s1">&#39;ActualLongitudeE&#39;</span><span class="p">:</span> <span class="mf">8.0</span><span class="p">,</span> <span class="s1">&#39;ActualLatitudeN&#39;</span><span class="p">:</span> <span class="mf">55.018777</span><span class="p">,</span>
             <span class="s1">&#39;ContainerMapView_Id&#39;</span><span class="p">:</span> <span class="mi">5036</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;Id&#39;</span><span class="p">:</span> <span class="mi">50363</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;38F73&#39;</span><span class="p">,</span> <span class="s1">&#39;LongitudeW&#39;</span><span class="p">:</span> <span class="mf">7.0</span><span class="p">,</span> <span class="s1">&#39;LatitudeS&#39;</span><span class="p">:</span> <span class="mf">54.5</span><span class="p">,</span> <span class="s1">&#39;LongitudeE&#39;</span><span class="p">:</span> <span class="mf">7.5</span><span class="p">,</span> <span class="s1">&#39;LatitudeN&#39;</span><span class="p">:</span> <span class="mf">54.75</span><span class="p">,</span>
             <span class="s1">&#39;Scale&#39;</span><span class="p">:</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;RasterFile&#39;</span><span class="p">:</span> <span class="s1">&#39;38F73.png&#39;</span><span class="p">,</span> <span class="s1">&#39;ImageWidth&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;ImageHeight&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;ActualLongitudeW&#39;</span><span class="p">:</span> <span class="mf">7.0</span><span class="p">,</span>
             <span class="s1">&#39;ActualLatitudeS&#39;</span><span class="p">:</span> <span class="mf">54.480204</span><span class="p">,</span> <span class="s1">&#39;ActualLongitudeE&#39;</span><span class="p">:</span> <span class="mf">7.5</span><span class="p">,</span> <span class="s1">&#39;ActualLatitudeN&#39;</span><span class="p">:</span> <span class="mf">54.769665</span><span class="p">,</span>
             <span class="s1">&#39;ContainerMapView_Id&#39;</span><span class="p">:</span> <span class="mi">5036</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;Id&#39;</span><span class="p">:</span> <span class="mi">50364</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;38F74&#39;</span><span class="p">,</span> <span class="s1">&#39;LongitudeW&#39;</span><span class="p">:</span> <span class="mf">7.5</span><span class="p">,</span> <span class="s1">&#39;LatitudeS&#39;</span><span class="p">:</span> <span class="mf">54.5</span><span class="p">,</span> <span class="s1">&#39;LongitudeE&#39;</span><span class="p">:</span> <span class="mf">8.0</span><span class="p">,</span> <span class="s1">&#39;LatitudeN&#39;</span><span class="p">:</span> <span class="mf">54.75</span><span class="p">,</span>
             <span class="s1">&#39;Scale&#39;</span><span class="p">:</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;RasterFile&#39;</span><span class="p">:</span> <span class="s1">&#39;38F74.png&#39;</span><span class="p">,</span> <span class="s1">&#39;ImageWidth&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;ImageHeight&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;ActualLongitudeW&#39;</span><span class="p">:</span> <span class="mf">7.5</span><span class="p">,</span>
             <span class="s1">&#39;ActualLatitudeS&#39;</span><span class="p">:</span> <span class="mf">54.480204</span><span class="p">,</span> <span class="s1">&#39;ActualLongitudeE&#39;</span><span class="p">:</span> <span class="mf">8.0</span><span class="p">,</span> <span class="s1">&#39;ActualLatitudeN&#39;</span><span class="p">:</span> <span class="mf">54.769665</span><span class="p">,</span>
             <span class="s1">&#39;ContainerMapView_Id&#39;</span><span class="p">:</span> <span class="mi">5036</span><span class="p">}]})</span></div>

<div class="viewcode-block" id="TMBTest.test_given_tile_id_get_tile_interface"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_given_tile_id_get_tile_interface">[docs]</a>    <span class="k">def</span> <span class="nf">test_given_tile_id_get_tile_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `given_tile_id_get_tile` exists and takes in a tile Id.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">given_tile_id_get_tile</span><span class="p">(</span><span class="mi">50361</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="mi">50361</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_given_tile_id_get_tile_actual_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_given_tile_id_get_tile_actual_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_given_tile_id_get_tile_actual_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `given_tile_id_get_tile` returns -1 when an unknown map tile id is passed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">given_tile_id_get_tile</span><span class="p">(</span><span class="mi">8675309</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_given_tile_id_get_tile_actual_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_given_tile_id_get_tile_actual_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_given_tile_id_get_tile_actual_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `given_tile_id_get_tile` returns the file of the map tile id.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">given_tile_id_get_tile</span><span class="p">(</span><span class="mi">50361</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;denmark_tiles&#39;</span><span class="p">,</span> <span class="s1">&#39;38F71.png&#39;</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">file_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="TMBTest.test_get_tile_1"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_get_tile_1">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_tile_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `get_tile` returns the calculated boundaries of a tile at scale 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">get_tile</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">11.47914</span><span class="p">,</span> <span class="mf">54.519373</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;south&#39;</span><span class="p">:</span> <span class="mf">54.5</span><span class="p">,</span> <span class="s1">&#39;north&#39;</span><span class="p">:</span> <span class="mf">57.5</span><span class="p">,</span> <span class="s1">&#39;west&#39;</span><span class="p">:</span> <span class="mf">7.0</span><span class="p">,</span> <span class="s1">&#39;east&#39;</span><span class="p">:</span> <span class="mf">13.0</span><span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_get_tile_2"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_get_tile_2">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_tile_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `get_tile` returns the calculated boundaries of a tile at scale 2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">get_tile</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">11.47914</span><span class="p">,</span> <span class="mf">54.519373</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;south&#39;</span><span class="p">:</span> <span class="mf">54.5</span><span class="p">,</span> <span class="s1">&#39;north&#39;</span><span class="p">:</span> <span class="mf">55.0</span><span class="p">,</span> <span class="s1">&#39;west&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;east&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span></div>

<div class="viewcode-block" id="TMBTest.test_get_tile_3"><a class="viewcode-back" href="../test_dao.html#test_dao.TMBTest.test_get_tile_3">[docs]</a>    <span class="k">def</span> <span class="nf">test_get_tile_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function `get_tile` returns the calculated boundaries of a tile at scale 2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmb</span> <span class="o">=</span> <span class="n">MySQL_DAO</span><span class="p">()</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">tmb</span><span class="o">.</span><span class="n">get_tile</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">11.47914</span><span class="p">,</span> <span class="mf">54.519373</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;south&#39;</span><span class="p">:</span> <span class="mf">54.5</span><span class="p">,</span> <span class="s1">&#39;north&#39;</span><span class="p">:</span> <span class="mf">54.75</span><span class="p">,</span> <span class="s1">&#39;west&#39;</span><span class="p">:</span> <span class="mf">11.0</span><span class="p">,</span> <span class="s1">&#39;east&#39;</span><span class="p">:</span> <span class="mf">11.5</span><span class="p">})</span></div></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;Milestone_4_Dump.mysql&#39;</span><span class="p">))</span>
    <span class="n">config_file</span> <span class="o">=</span> <span class="s1">&#39;connection_data.conf&#39;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">configparser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>

    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;cat &#39;</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="s1">&#39; | mysql -u &#39;</span> <span class="o">+</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;SQL&#39;</span><span class="p">][</span><span class="s1">&#39;user&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; --password=&#39;</span> <span class="o">+</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;SQL&#39;</span><span class="p">][</span><span class="s1">&#39;password&#39;</span><span class="p">])</span>

    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">CS418_Milestone_4</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">CS418_Milestone4</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Group 5.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>